<!DOCTYPE html>
<html lang='en'>

<head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='As you might know, there are a lot of blocked services in Russia, LinkedIn, Telegram, etc., and lately, I start to use LinkedIn more extensively. I tried to use some free VPN services, like FlyVPN, Tunnel Bear, but they all have restrictions and slow. That&rsquo;s why I decided to run my own VPN server on some cloud platform. I know that you can run droplet in the digital ocean for only 5$ a month ,'>

<meta property='og:title' content='Free VPN server on GCP in 5 minutes • IT Notes'>
<meta property='og:description' content='As you might know, there are a lot of blocked services in Russia, LinkedIn, Telegram, etc., and lately, I start to use LinkedIn more extensively. I tried to use some free VPN services, like FlyVPN, Tunnel Bear, but they all have restrictions and slow. That&rsquo;s why I decided to run my own VPN server on some cloud platform. I know that you can run droplet in the digital ocean for only 5$ a month ,'>
<meta property='og:url' content='https://blog.aborilov.ru/post/vpn/'>
<meta property='og:site_name' content='IT Notes'>
<meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2018-04-17T09:29:16&#43;03:00'/><meta property='article:modified_time' content='2018-04-17T09:29:16&#43;03:00'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.37.1" />

  <title>Free VPN server on GCP in 5 minutes • IT Notes</title>
  <link rel='canonical' href='https://blog.aborilov.ru/post/vpn/'>
  
  
  <link rel='icon' href='../../favicon.ico'>
<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Ubuntu:400,400i,700&subset=latin'>
<link rel='stylesheet' href='../../assets/css/main.77da63e1.css'><link rel='stylesheet' href='../../css/custom.css'>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-7387908-2', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>

</head>


<body class='page type-post'>
  <div class='site'>

    <a class='screen-reader' href='#main'>Skip to Content</a>

    <header id='header' class='header-container'>
      <div class='header site-header'>
        <nav id='main-menu' class='main-menu-container' aria-label='Main Menu'>
  <ul class='main-menu'>
  <li>
      <a href='../../'>Home</a>
    </li>
  <li>
      <a href='../../post'>Posts</a>
    </li>
  
  </ul>
</nav>

        <div class='header-info'>
          
          <p class='site-title title'>IT Notes</p>
          
          <p class='site-description subtitle'>Aborilov Pavel&#39;s thoughts</p>
        </div>
      </div>
    </header>


<main id='main' class='main'>
  <article lang='en' class='entry'>
    <header class='header-container'>
  <div class='header entry-header'>
    <div class='header-info'>
      <h1 class='title'>Free VPN server on GCP in 5 minutes</h1>
      

    </div>
    
<div class='meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader'>Posted on </span>
  <time class='date' datetime='2018-04-17T09:29:16&#43;03:00'>2018, Apr 17</time>
</span>

  
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
3 mins read
</span>


</div>


  </div>
</header>

    
    

    <div class='entry-content'>
  <p>As you might know, there are a lot of blocked services in Russia, LinkedIn, Telegram, etc.,
and lately, I start to use LinkedIn more extensively. I tried to use some free VPN services, like <a href="https://www.flyvpn.com/" target="_blank">FlyVPN</a>, <a href="https://www.tunnelbear.com/" target="_blank">Tunnel Bear</a>,
but they all have restrictions and slow. That&rsquo;s why I decided to run my own VPN server on some cloud platform.
I know that you can run droplet in the <a href="https://www.digitalocean.com/pricing/" target="_blank">digital ocean for only 5$ a month</a>
<div class='align-center'>
  <p><img src="../../droplet.png" alt="droplet for 5$" />,</p>

</div>

the same for <a href="https://www.linode.com/pricing" target="_blank">linode</a>
<div class='align-center'>
  <p><img src="../../linode.png" alt="linode server" /></p>

</div>

but on Google Cloud Platform, you can have <a href="https://cloud.google.com/free/docs/always-free-usage-limits" target="_blank">always free f1-micro instance</a>,
so I decided to go that way.</p>

<p>First, we create new <code>micro</code> instance in one of the us-east1, us-west1, and us-central1 regions.
I&rsquo;m using image <code>Ubuntu 17.10</code>, we don&rsquo;t need any SSD, just persistent 10Gb disk,
we need to allow HTTP and HTTPS traffic, our VPN server will be available over HTTPs
and we need HTTP for LetsEncrypt verification.
<div class='align-center'>
  <p><img src="../../create_instance.png" alt="create new instance" /></p>

</div>

In the <code>VPC network-&gt;Firewall rules</code> we need to add port for our VPN server, I&rsquo;m using port <code>18450</code> you can use another.
<div class='align-center'>
  <p><img src="../../firewall_rule.png" alt="add firewall rule" /></p>

</div>

Next, we need to add the tag from firewall rule to our new instance. So go to our newly created instance and press <code>Edit</code>:
<div class='align-center'>
  <p><img src="../../add_tag.png" alt="add tag" /></p>

</div>

while we editing instance setting we need also to add external static IP:
under <code>Network interfaces</code>
<div class='align-center'>
  <p><img src="../../network.png" alt="Network interfaces" /></p>

</div>

create new static IP
<div class='align-center'>
  <p><img src="../../static_ip.png" alt="add static IP" /></p>

</div>
</p>

<p>If you like me and all your DNS record already in <code>Cloud DNS</code> you can add new DNS record for this IP under <code>Network services-&gt;Cloud DNS</code>:
<div class='align-center'>
  <p><img src="../../dns.png" alt="add DNS name" /></p>

</div>

We will need this DNS name for LetsEncrypt verification.</p>

<p>OK, our instance is ready, now we need to install VPN server.
Connect to the instance through SSH web-based client:
<div class='align-center'>
  <p><img src="../../ssh.png" alt="SSH" /></p>

</div>
</p>

<p>We will be using <a href="https://pritunl.com/" target="_blank">PRITUNL</a> because it has excellent webUI.
Official instruction can be found <a href="https://docs.pritunl.com/docs/installation" target="_blank">here</a>, but it&rsquo;s very simple, so I&rsquo;ll show all steps here:</p>

<p>just run following command</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo tee -a /etc/apt/sources.list.d/pritunl.list <span style="color:#e6db74">&lt;&lt; EOF
</span><span style="color:#e6db74">deb http://repo.pritunl.com/stable/apt artful main
</span><span style="color:#e6db74">EOF</span>

sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com --recv 7568D9BB55FF9E5287D586017AE645C0CF8E292A
sudo apt-get update
sudo apt-get --assume-yes install pritunl mongodb-server
sudo systemctl start pritunl mongodb
sudo systemctl enable pritunl mongodb</code></pre></div>

<p>That&rsquo;s all, now you can go to <a href="https://vpn.youdomains.com" target="_blank">https://vpn.youdomains.com</a>
<div class='align-center'>
  <p><img src="../../pritunl_setup_key.png" alt="pritunl setupkey" /></p>

</div>

To get the setup key run the command <code>pritunl setup-key</code> this will return the setup key.
By default, the MongoDB uri will be filled with the uri for the localhost MongoDB server.
This should be left as it is when the MongoDB server is running on the same server as the Pritunl instance.</p>

<p>After that, you already can login with username and password - <code>pritunl</code></p>

<p>Next, on the <code>Initial Setup</code> screen, you need to set <code>Username</code>, <code>New Password</code>,
<code>Public Address</code> and set <code>LetsEncrypt Domain</code> to your newly created domain name.
<div class='align-center'>
  <p><img src="../../initial_setup.png" alt="initial setup" /></p>

</div>

Now we just need to add organization
<div class='align-center'>
  <p><img src="../../create_org.png" alt="add organization" /></p>

</div>

add new user to this organization
<div class='align-center'>
  <p><img src="../../create_user.png" alt="add user" /></p>

</div>

add new server
<div class='align-center'>
  <p><img src="../../add_server.png" alt="add server" /></p>

</div>

don&rsquo;t forget to set port the same as in <code>Firewall rule</code></p>

<p>attach server to the organization
<div class='align-center'>
  <p><img src="../../attach_org.png" alt="add server" /></p>

</div>

Then click Start Server to start the vpn server.</p>

<p>After the server has been created the user profile can be downloaded on the
<code>Users</code> page by clicking the download button or profile links button on the right side of a user.
The profile can then be imported into the <code>Pritunl</code> client or any other <code>OpenVPN</code> client.</p>

<p>That&rsquo;s all, your VPN server is ready.</p>

<p>I use <a href="https://client.pritunl.com/" target="_blank">pritunl client</a> on macos and openvpn on <a href="https://play.google.com/store/apps/details?id=net.openvpn.openvpn" target="_blank">android</a> and on <a href="https://itunes.apple.com/ru/app/openvpn-connect/id590379981?mt=8" target="_blank">iOS</a></p>

</div>

    
<footer class='entry-footer-container'>
  <div class='entry-footer'>
  
  </div>
</footer>


  </article>
  
<nav class='entry-nav-container'>
  <div class='entry-nav'><div class='prev-entry'>
      <a href='../../post/network_manager_dmenu/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader'>Previous post: </span>Переключение между сетевыми профилями NetworkManager через dmenu</a>
    </div><div class='next-entry'>
      <a href='../../post/proxy/'>
        <span class='screen-reader'>Next post: </span>SOCKS5 proxy server in 2 minutes<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>

  
<div class='comments-container'>
  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "blog-aborilov-ru" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

</main>

    <footer id='footer' class='footer-container'>
      <div class='footer'>
        <div class='social-menu-container'>
  <nav aria-label='Social Menu'>
    <ul class='social-menu'><li>
        <a href='https://github.com/aborilov' target='_blank' rel='noopener'>
          <span class='screen-reader'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='https://facebook.com/pavel.aborilov' target='_blank' rel='noopener'>
          <span class='screen-reader'>Open Facebook account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
  
</svg>
</a>
      </li><li>
        <a href='https://twitter.com/aborilov' target='_blank' rel='noopener'>
          <span class='screen-reader'>Open Twitter account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
  
</svg>
</a>
      </li><li>
        <a href='mailto:pavel@aborilov.ru' target='_blank' rel='noopener'>
          <span class='screen-reader'>Contact via Email</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
  <polyline points="22,6 12,13 2,6"/>
  
</svg>
</a>
      </li><li>
        <a href='https://linkedin.com/in/pavel-aborilov-19772bb0' target='_blank' rel='noopener'>
          <span class='screen-reader'>Open Linkedin account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path stroke-width="1.8" d="m5.839218,4.101561c0,1.211972 -0.974141,2.194011 -2.176459,2.194011s-2.176459,-0.982039 -2.176459,-2.194011c0,-1.211094 0.974141,-2.194011 2.176459,-2.194011s2.176459,0.982917 2.176459,2.194011zm0.017552,3.94922l-4.388022,0l0,14.04167l4.388022,0l0,-14.04167zm7.005038,0l-4.359939,0l0,14.04167l4.360816,0l0,-7.370999c0,-4.098413 5.291077,-4.433657 5.291077,0l0,7.370999l4.377491,0l0,-8.89101c0,-6.915523 -7.829986,-6.66365 -9.669445,-3.259423l0,-1.891237z"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</div>
        <div class='copyright'>
  <p>
        
          
        
      

       &copy; 2008-2018 Aborilov Pavel 
  </p>
</div>

      </div>
    </footer>

  </div><script src='../../assets/js/main.f29c93b9.js'></script><script src='../../js/custom.js'></script></body>

</html>

